<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for alphacontracts/contracts/Owned.sol</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../prettify.css" />
    <link rel="stylesheet" href="../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../index.html">all files</a> / <a href="index.html">alphacontracts/contracts/</a> Owned.sol
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/12</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/10</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/7</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/20</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">pragma solidity 0.4.24;
import './Database.sol';
&nbsp;
//------------------------------------------------------------------------------------------------------------------
// This contract handles owner authorization, freezing and access to critical functions
//------------------------------------------------------------------------------------------------------------------
contract Owned {
&nbsp;
  Database public database;
&nbsp;
  //------------------------------------------------------------------------------------------------------------------
  // Constructor: Initialize database
  //------------------------------------------------------------------------------------------------------------------
<span class="fstat-no" title="function not covered" >  constructor(address _database)</span>
  noZeroAddress(_database)
  public {
<span class="cstat-no" title="statement not covered" >    database = Database(_database)</span>;
  }
&nbsp;
  //------------------------------------------------------------------------------------------------------------------
  // This function requires 2 of 3 owners to sign off on. Will replace one owner for another.
  // @Param: The address of the new owner address
  // @Param: The index of the new owner
  // @Param: The address of the first signer, who has approved the calling of this function
  //------------------------------------------------------------------------------------------------------------------
<span class="fstat-no" title="function not covered" >  function changeOwner(address _newOwner, address _oldOwner, address _functionSigner)</span>
  anyOwner
  noZeroAddress(_newOwner)
  noZeroAddress(_functionSigner)
  external {
<span class="cstat-no" title="statement not covered" >    require(msg.sender != _functionSigner)</span>;         // Check that this is different owner than the one who authorized
<span class="cstat-no" title="statement not covered" >    bytes32 functionHash = keccak256(abi.encodePacked(address(this), _functionSigner, "changeOwner", keccak256(abi.encodePacked(_newOwner))))</span>;
<span class="cstat-no" title="statement not covered" >    require(database.boolStorage(functionHash))</span>;   // Check that fuction has been authorized to be called with these parameters
    database.setBool(functionHash, false);         // Reset changeOwner() authorization
    database.deleteBool(keccak256(abi.encodePacked("owner", _oldOwner)));      // Remove old owners privileges
    database.setBool(keccak256(abi.encodePacked("owner", _newOwner)), true);
<span class="cstat-no" title="statement not covered" >    emit LogOwnerChanged(_oldOwner, _newOwner);</span>
  }
&nbsp;
  //------------------------------------------------------------------------------------------------------------------
  // This function authorizes other owners to call critical functions such as selfdestruct or changeOwner() or add/remove contracts in ContractManager.
  // The critical functions often involve having a critical address change. If address is not critical any agreed address will work
  // Note: beneficiary is used in case an attacker gains control of one owner wallet, the other owner would need to also agree on the critical parameter which is in the format keccak256(criticalParameter)
  //------------------------------------------------------------------------------------------------------------------
<span class="fstat-no" title="function not covered" >  function setFunctionAuthorized(address _contractAddress, string _functionName, bytes32 _beneficiary)</span>
  external
  anyOwner
  returns (bool) {
<span class="cstat-no" title="statement not covered" >    require(bytes(_functionName).length != uint(0))</span>;
<span class="cstat-no" title="statement not covered" >    bytes32 functionAuthHash = keccak256(abi.encodePacked(_contractAddress, msg.sender, _functionName, _beneficiary))</span>; 
    database.setBool(functionAuthHash, true);    // Sign the function name + parameter
<span class="cstat-no" title="statement not covered" >    emit LogFunctionAuthorized(msg.sender, _functionName, _beneficiary, functionAuthHash);</span>
  }
&nbsp;
  //------------------------------------------------------------------------------------------------------------------
  // This will pause all critical activity for the supplied address
  // @Param: The address of the contract which is to be paused\
  //------------------------------------------------------------------------------------------------------------------
<span class="fstat-no" title="function not covered" >  function pause(address _contract)</span>
  anyOwner
  noZeroAddress(_contract)
  public {
    database.setBool(keccak256(abi.encodePacked("pause", _contract)), true);
<span class="cstat-no" title="statement not covered" >    emit LogPaused(_contract);</span>
  }
&nbsp;
  //------------------------------------------------------------------------------------------------------------------
  // This will unpause all critical activity for the supplied address
  // @Param: The address of the contract which is to be unpaused
  //------------------------------------------------------------------------------------------------------------------
<span class="fstat-no" title="function not covered" >  function unpause(address _contract)</span>
  anyOwner
  public {
    database.setBool(keccak256(abi.encodePacked("pause", _contract)), false);
<span class="cstat-no" title="statement not covered" >    emit LogUnpaused(_contract);</span>
  }
&nbsp;
&nbsp;
&nbsp;
&nbsp;
  //------------------------------------------------------------------------------------------------------------------
  //                                                Modifiers
  //------------------------------------------------------------------------------------------------------------------
&nbsp;
&nbsp;
  //------------------------------------------------------------------------------------------------------------------
  // Verifies sthat sender is an owners
  //------------------------------------------------------------------------------------------------------------------
<span class="fstat-no" title="function not covered" >  modifier anyOwner </span>{
<span class="cstat-no" title="statement not covered" >    require(database.boolStorage(keccak256(abi.encodePacked("owner", msg.sender))))</span>;
    _;
  }
&nbsp;
  //------------------------------------------------------------------------------------------------------------------
  // Verifies no empty addresses are input
  //------------------------------------------------------------------------------------------------------------------
<span class="fstat-no" title="function not covered" >  modifier noZeroAddress(address _param) </span>{
<span class="cstat-no" title="statement not covered" >    require (_param != address(0))</span>;
    _;
  }
&nbsp;
&nbsp;
  //------------------------------------------------------------------------------------------------------------------
  //                                              Events
  //------------------------------------------------------------------------------------------------------------------
  event LogPaused(address indexed _contract);
  event LogUnpaused(address indexed _contract);
  event LogOwnerChanged(address indexed _previousOwner, address indexed _newOwner);
  event LogFunctionAuthorized(address indexed _owner, string indexed _functionName, bytes32 indexed _beneficiary, bytes32 _authHash);
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Sat Sep 08 2018 07:28:40 GMT-0700 (PDT)
</div>
</div>
<script src="../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../sorter.js"></script>
</body>
</html>
